FROM node:18

ARG PINECONE_API_KEY
ARG PINECONE_ENV
ARG PINECONE_INDEX

ENV PINECONE_API_KEY $PINECONE_API_KEY
ENV PINECONE_ENV $PINECONE_ENV
ENV PINECONE_INDEX $PINECONE_INDEX

ENV NODE_ENV production

WORKDIR /usr/src/app

COPY package.json ./

COPY yarn.lock ./

RUN yarn install

COPY . .

RUN yarn build

EXPOSE 3000

CMD yarn start